## Chapter 1. 운영체제, 컴퓨터 시스템

### 운영체제
![image](https://user-images.githubusercontent.com/55453184/168225234-3df5738c-337d-4b19-a82f-01831bd24149.png)  
* 하드웨어: 계산, 저장, 입출력 장치
* 응용 프로그램: 사용자가 원하는 연산을 위해 하드웨어 자원의 사용 방법을 정의
* 운영체제: 응용 프로그램이 자원을 접근하기 위해 하드웨어를 조정 및 관리
- - -
### 컴퓨터 시스템
![image](https://user-images.githubusercontent.com/55453184/168234480-6640e7f0-a741-440c-82e1-6a8497d2b61a.png)  
각 하드웨어 장치에는 **장치 컨트롤러**가 있고, 이들은 버스로 연결되어 있으며, 운영체제는 이들마다 **장치 드라이버**가 있다. 장치 드라이버는 컨트롤러의 동작을 파악하고, 운영체제에게 장치를 다룰 수 있는 인터페이스를 제공한다.  
장치 컨트롤러는 CPU와 병렬로 연결되어 메모리 접근 순서를 두고 경쟁한다.

#### 인터럽트
![image](https://user-images.githubusercontent.com/55453184/168235361-3235554b-cd41-4aee-b117-cc919ed07b88.png)
* 하드웨어가 특정 작업을 완료하거나 오류가 발생할 경우 비동기적으로 CPU에게 이벤트를 보내는데, 이를 **인터럽트**라고 한다.
* 인터럽트가 발생하면, 각 인터럽트가 발생한 상황에 맞는 **인터럽트 핸들러 루틴**이 존재하는데, 이들의 주소 값은 **인터럽트 벡터**라는 배열에 저장되어 있다.
* CPU가 명령을 완료할 때마다 **인터럽트 요청 라인**에 신호가 왔는지를 확인하고, 장치 컨트롤러가 인터럽트 요청 라인에 보낸 신호(raise) 가 감지되었으면(catch) 인터럽트 번호를 읽는다. 그리고 이를 인덱스 삼아 인터럽트 벡터에 접근한 후 인터럽트 핸들러 루틴으로 점프(dispatch)하여 필요한 작업을 처리한다.
* 인터럽트 처리기가 원인을 파악하고 변경될 상태를 저장하고 나면, return_from_interrupt 명령을 실행하여 CPU를 인터럽트 발생 전으로 복구한다(clear).
* 최신 하드웨어는 상황에 따라 인터럽트를 연기하고, 인터럽트의 종류에 따라 우선순위를 나누며, 효율적으로 dispatch하도록 하는 **인터럽트 컨트롤러 하드웨어**가 존재한다.
* 실제로 연결된 장치가 인터럽트 벡터의 주소 개수보다 많을 수 있는데, 이를 해결하기 위해 **인터럽트 체인**을 사용한다. 각 벡터의 원소마다 인터럽트 핸들러 리스트의 헤드를 가리키도록 하고, 인터럽트 발생 시 원하는 핸들러가 발견될 때까지 핸들러가 하나씩 호출된다.

#### 저장장치 구조
* **메인 메모리(random-access memory, RAM)**: CPU는 프로그램이 실행되면 메인 메모리에 적재한다. 메인 메모리는 휘발성이며, Dynamic RAM 반도체 기술로 구현된다.
* **전기적으로 소거 가능한 프로그램 가능 읽기 전용 메모리(EEPROM)**: 주로 사용되지 않는 정적 프로그램과 데이터가 저장되어 있으며, 부트스트랩 프로그램을 저장한다. 부트스트랩 프로그램 컴퓨터의 전원을 입력하면 가장 먼저 실행되며, 운영체제를 적재한다.
* **보조저장장치(HDD, NVM)**: 프로그램과 데이터를 영구히 저장할 수 있는 장치이다.
* **3차 저장장치**: 백업 사본을 저장하기 위한 장치로, 용량이 큰 대신 속도가 느리다.

#### 입출력 구조
![image](https://user-images.githubusercontent.com/55453184/168235263-d2c460bd-f33f-49d3-99b3-31254dcf8627.png)
* 보조저장장치의 대량의 데이터를 버스를 통해 옮길 때의 높은 오버헤드 발생을 방지하기 위해 **직접 메모리 액세스(DMA)**가 사용된다.
* DMA는 버퍼와 입출력 카운트를 세팅한 후 장치 컨트롤러가 CPU의 개입 없이 데이터 블록 전체를 전송한다.
* 모든 데이터가 전송되면 인터럽트가 발생하므로, 데이터 전송 과정에서 CPU는 다른 작업을 수행할 수 있다.
- - -
### 컴퓨터 시스템
컴퓨터 시스템에 사용된 법용 처리기의 수에 따라 다양한 방식의 구조로 나뉜다.

#### 단일 처리기 시스템(single process systems)
* 단일 코어를 가진 CPU를 포함하는 시스템을 단일 처리기 시스템이라 한다.
* 현대 컴퓨터 시스템 중 단일 처리 시스템은 없다.

#### 다중 처리기 시스템(multiprocessor systems)
![image](https://user-images.githubusercontent.com/55453184/168240665-ddd4d363-4dd1-4198-ae0f-e9ecbbba70e1.png)
* 단일 코어를 가진 CPU가 2개 이상 있는 프로세서를 포함하는 시스템을 다중 처리기 시스템이라 한다. 이때 CPU를 N개 늘려도 이들을 관리하는 오버헤드가 있으므로 성능이 N배가 되지 않는다.
* SMP(symmetric multiprocessing): 개별 레지스터와 로컬 캐시가 있는 CPU들이 메모리를 공유하는 대칭적인 구조를 말한다. 여러 프로세서 중 일부만 과부화되는 단점을 보완하고 효율적으로 가동할 수 있다.
* 대부분의 아키텍처는 로컬 레벨1 캐시와 공유 레벨2 캐시를 결합한 구조를 채택한다.  
![image](https://user-images.githubusercontent.com/55453184/168240728-41dede64-4a1b-42f9-9a9d-59dd0780cfa9.png)
* NUMA(non-uniform memory access): CPU가 증가하면 발생하는 병목 현상을 해결하기 위해, 각 CPU에 로컬 메모리를 연결하여 서로 주소 공간을 공유하도록 한다. 그러나 CPU의 로컬 메모리에 접근하는 속도는 빠르나, 다른 CPU의 메모리에 접근하는 속도가 느려 성능 저하가 발생한다. CPU 스케쥴링 및 메모리 관리를 통해 이 문제를 최소화할 수 있다.

#### 클러스터형 시스템(clustered systems)
* 둘 이상의 노드(시스템)들이 연결하여 구성되는 시스템이다. 각 노드들은 다중 처리기 시스템이다.
* 여러 노드 중 하나의 노드가 비정상적으로 종료되어도 다른 노드가 서비스를 운영하므로 높은 가용성을 보인다.
* 하나의 노드가 실행될 때 나머지 노드가 대기 모드 상태를 유지하는 **비대칭형 클러스터링**과, 노드들이 서로 감시하면서 운영하는 **대칭형 클러스터링**이 있다.
